<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Splitting App</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h2 {
            color: #007BFF;
            margin-bottom: 20px;
        }

        form, ul, .results, .assignments {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        input[type="text"], input[type="number"], select, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .hidden {
            display: none;
        }
        
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }

            h2 {
                font-size: 1.5em;
            }

            form, ul, .results, .assignments {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h2>Bill Splitting App</h2>
    
    <!-- Step 1: Enter Friends' Names -->
    <form id="friendsForm">
        <h3>Step 1: Enter Friends' Names</h3>
        <label for="friendName">Friend's Name:</label>
        <input type="text" id="friendName" name="friendName" required>
        <button type="submit">Add Friend</button>
    </form>
    
    <ul id="friendsList" class="hidden">
        <!-- Friends will be listed here -->
    </ul>
    
    <!-- Step 2: Enter Dishes and Costs -->
    <form id="dishesForm" class="hidden">
        <h3>Step 2: Enter Dishes and Costs</h3>
        <label for="dishName">Dish Name:</label>
        <input type="text" id="dishName" name="dishName" required>
        <label for="cost">Cost:</label>
        <input type="number" id="cost" name="cost" step="0.01" required>
        <button type="submit">Add Dish</button>
    </form>
    
    <ul id="dishesList" class="hidden">
        <!-- Dishes will be listed here -->
    </ul>
    
    <!-- Step 3: Select Friends for Each Dish -->
    <form id="sharingForm" class="hidden">
        <h3>Step 3: Select Friends for Each Dish</h3>
        <select id="dishSelect">
            <!-- Dishes will be listed here -->
        </select>
        <div id="friendsCheckboxes">
            <!-- Friends' checkboxes will be added here -->
        </div>
        <button type="submit">Assign Friends to Dish</button>
    </form>
    
    <ul id="assignmentList" class="hidden assignments">
        <!-- Assignments will be displayed here -->
    </ul>
    
    <!-- Step 4: Show Results -->
    <button id="calculateBtn" class="hidden">Calculate</button>
    <div id="results" class="hidden results">
        <h3>Results</h3>
        <ul id="resultsList">
            <!-- Results will be displayed here -->
        </ul>
    </div>
    
    <script>
        const friendsForm = document.getElementById('friendsForm');
        const dishesForm = document.getElementById('dishesForm');
        const sharingForm = document.getElementById('sharingForm');
        const friendsList = document.getElementById('friendsList');
        const dishesList = document.getElementById('dishesList');
        const friendsCheckboxes = document.getElementById('friendsCheckboxes');
        const dishSelect = document.getElementById('dishSelect');
        const calculateBtn = document.getElementById('calculateBtn');
        const resultsDiv = document.getElementById('results');
        const resultsList = document.getElementById('resultsList');
        const assignmentList = document.getElementById('assignmentList');
        
        let friends = [];
        let dishes = [];
        let dishFriendsMap = new Map();
        
        friendsForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const friendName = document.getElementById('friendName').value;
            friends.push(friendName);
            updateFriendsList();
            updateFriendsCheckboxes();
            friendsForm.reset();
            if (friends.length > 0) {
                friendsList.classList.remove('hidden');
                dishesForm.classList.remove('hidden');
            }
        });
        
        dishesForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const dishName = document.getElementById('dishName').value;
            const cost = parseFloat(document.getElementById('cost').value).toFixed(2);
            dishes.push({ dishName, cost });
            updateDishesList();
            updateDishSelect();
            dishesForm.reset();
            if (dishes.length > 0) {
                dishesList.classList.remove('hidden');
                sharingForm.classList.remove('hidden');
            }
        });
        
        sharingForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const selectedDish = dishSelect.value;
            const selectedFriends = Array.from(document.querySelectorAll('#friendsCheckboxes input:checked')).map(input => input.value);
            dishFriendsMap.set(selectedDish, selectedFriends);
            updateAssignmentList();
            sharingForm.reset();
            calculateBtn.classList.remove('hidden');
        });
        
        calculateBtn.addEventListener('click', function() {
            let friendCostMap = new Map();
            friends.forEach(friend => friendCostMap.set(friend, 0));
            
            dishes.forEach(dish => {
                const { dishName, cost } = dish;
                const sharedFriends = dishFriendsMap.get(dishName) || [];
                const sharedCost = parseFloat(cost) / sharedFriends.length;
                
                sharedFriends.forEach(friend => {
                    friendCostMap.set(friend, friendCostMap.get(friend) + sharedCost);
                });
            });
            
            updateResultsList(friendCostMap);
        });
        
        function updateFriendsList() {
            friendsList.innerHTML = friends.map(friend => `<li>${friend}</li>`).join('');
        }
        
        function updateDishesList() {
            dishesList.innerHTML = dishes.map(dish => `<li>${dish.dishName} - $${dish.cost}</li>`).join('');
        }
        
        function updateFriendsCheckboxes() {
            friendsCheckboxes.innerHTML = friends.map(friend => `<label><input type="checkbox" value="${friend}"> ${friend}</label>`).join('');
        }
        
        function updateDishSelect() {
            dishSelect.innerHTML = dishes.map(dish => `<option value="${dish.dishName}">${dish.dishName}</option>`).join('');
        }
        
        function updateAssignmentList() {
            assignmentList.innerHTML = '';
            dishFriendsMap.forEach((friends, dish) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${dish}: ${friends.join(', ')}`;
                assignmentList.appendChild(listItem);
            });
            assignmentList.classList.remove('hidden');
        }
        
        function updateResultsList(friendCostMap) {
            resultsList.innerHTML = '';
            friendCostMap.forEach((cost, friend) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${friend} owes $${cost.toFixed(2)}`;
                resultsList.appendChild(listItem);
            });
            resultsDiv.classList.remove('hidden');
        }
    </script>
</body>
</html>

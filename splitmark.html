<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Splitting App</title>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        form {
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h2>Bill Splitting App</h2>
    
    <!-- Step 1: Enter Friends' Names -->
    <form id="friendsForm">
        <h3>Step 1: Enter Friends' Names</h3>
        <label for="friendName">Friend's Name:</label>
        <input type="text" id="friendName" name="friendName" required>
        <button type="submit">Add Friend</button>
    </form>
    
    <ul id="friendsList">
        <!-- Friends will be listed here -->
    </ul>
    
    <!-- Step 2: Enter Dishes and Costs -->
    <form id="dishesForm" class="hidden">
        <h3>Step 2: Enter Dishes and Costs</h3>
        <label for="dishName">Dish Name:</label>
        <input type="text" id="dishName" name="dishName" required>
        <label for="cost">Cost:</label>
        <input type="number" id="cost" name="cost" step="0.01" required>
        <button type="submit">Add Dish</button>
    </form>
    
    <ul id="dishesList">
        <!-- Dishes will be listed here -->
    </ul>
    
    <!-- Step 3: Select Friends for Each Dish -->
    <form id="sharingForm" class="hidden">
        <h3>Step 3: Select Friends for Each Dish</h3>
        <select id="dishSelect">
            <!-- Dishes will be listed here -->
        </select>
        <div id="friendsCheckboxes">
            <!-- Friends' checkboxes will be added here -->
        </div>
        <button type="submit">Assign Friends to Dish</button>
    </form>
    
    <ul id="assignmentList">
        <!-- Assignments will be displayed here -->
    </ul>
    
    <!-- Step 4: Show Results -->
    <button id="calculateBtn" class="hidden">Calculate</button>
    <div id="results" class="hidden">
        <h3>Results</h3>
        <ul id="resultsList">
            <!-- Results will be displayed here -->
        </ul>
    </div>
    
    <script>
        const friendsForm = document.getElementById('friendsForm');
        const dishesForm = document.getElementById('dishesForm');
        const sharingForm = document.getElementById('sharingForm');
        const friendsList = document.getElementById('friendsList');
        const dishesList = document.getElementById('dishesList');
        const friendsCheckboxes = document.getElementById('friendsCheckboxes');
        const dishSelect = document.getElementById('dishSelect');
        const calculateBtn = document.getElementById('calculateBtn');
        const resultsDiv = document.getElementById('results');
        const resultsList = document.getElementById('resultsList');
        const assignmentList = document.getElementById('assignmentList');
        
        let friends = [];
        let dishes = [];
        let dishFriendsMap = new Map();
        
        friendsForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const friendName = document.getElementById('friendName').value;
            friends.push(friendName);
            updateFriendsList();
            updateFriendsCheckboxes();
            friendsForm.reset();
            if (friends.length > 0) {
                dishesForm.classList.remove('hidden');
            }
        });
        
        dishesForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const dishName = document.getElementById('dishName').value;
            const cost = parseFloat(document.getElementById('cost').value).toFixed(2);
            dishes.push({ dishName, cost });
            updateDishesList();
            updateDishSelect();
            dishesForm.reset();
            if (dishes.length > 0) {
                sharingForm.classList.remove('hidden');
            }
        });
        
        sharingForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const selectedDish = dishSelect.value;
            const selectedFriends = Array.from(document.querySelectorAll('#friendsCheckboxes input:checked')).map(input => input.value);
            dishFriendsMap.set(selectedDish, selectedFriends);
            updateAssignmentList();
            sharingForm.reset();
            calculateBtn.classList.remove('hidden');
        });
        
        calculateBtn.addEventListener('click', function() {
            let friendCostMap = new Map();
            friends.forEach(friend => friendCostMap.set(friend, 0));
            
            dishes.forEach(dish => {
                const { dishName, cost } = dish;
                const sharedFriends = dishFriendsMap.get(dishName) || [];
                const sharedCost = parseFloat(cost) / sharedFriends.length;
                
                sharedFriends.forEach(friend => {
                    friendCostMap.set(friend, friendCostMap.get(friend) + sharedCost);
                });
            });
            
            updateResultsList(friendCostMap);
        });
        
        function updateFriendsList() {
            friendsList.innerHTML = friends.map(friend => `<li>${friend}</li>`).join('');
        }
        
        function updateDishesList() {
            dishesList.innerHTML = dishes.map(dish => `<li>${dish.dishName} - $${dish.cost}</li>`).join('');
        }
        
        function updateFriendsCheckboxes() {
            friendsCheckboxes.innerHTML = friends.map(friend => `<label><input type="checkbox" value="${friend}"> ${friend}</label>`).join('');
        }
        
        function updateDishSelect() {
            dishSelect.innerHTML = dishes.map(dish => `<option value="${dish.dishName}">${dish.dishName}</option>`).join('');
        }
        
        function updateAssignmentList() {
            assignmentList.innerHTML = '';
            dishFriendsMap.forEach((friends, dish) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${dish}: ${friends.join(', ')}`;
                assignmentList.appendChild(listItem);
            });
        }
        
        function updateResultsList(friendCostMap) {
            resultsList.innerHTML = '';
            friendCostMap.forEach((cost, friend) => {
                const listItem = document.createElement('li');
                listItem.textContent = `${friend} owes $${cost.toFixed(2)}`;
                resultsList.appendChild(listItem);
            });
            resultsDiv.classList.remove('hidden');
        }
    </script>
</body>
</html>
